<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>出席管理アプリ フローチャート</title>
<style>
    body {
        font-family: "Segoe UI", sans-serif;
        background: #f4f6f8;
    }
    h1 {
        text-align: center;
    }
    svg {
        display: block;
        margin: auto;
        background: #ffffff;
        border: 1px solid #ccc;
    }
    .box {
        fill: #e3f2fd;
        stroke: #1565c0;
        stroke-width: 2;
    }
    .decision {
        fill: #fff3e0;
        stroke: #ef6c00;
        stroke-width: 2;
    }
    .end {
        fill: #e8f5e9;
        stroke: #2e7d32;
        stroke-width: 2;
    }
    .text {
        font-size: 14px;
        fill: #000;
        text-anchor: middle;
        dominant-baseline: middle;
    }
    .arrow {
        stroke: #000;
        stroke-width: 2;
        marker-end: url(#arrowhead);
    }
</style>
</head>
<body>

<h1>出席管理アプリ フローチャート</h1>

<svg width="800" height="950">

    <!-- 矢印定義 -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7"
                refX="10" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#000"/>
        </marker>
    </defs>

    <!-- 開始 -->
    <rect x="300" y="20" width="200" height="50" class="box"/>
    <text x="400" y="45" class="text">アプリ起動</text>

    <!-- カメラ権限 -->
    <polygon points="400,100 520,150 400,200 280,150" class="decision"/>
    <text x="400" y="145" class="text">カメラ権限あり？</text>

    <!-- 権限なし -->
    <rect x="50" y="230" width="220" height="60" class="box"/>
    <text x="160" y="260" class="text">権限リクエスト</text>

    <!-- QR読取 -->
    <rect x="300" y="260" width="200" height="60" class="box"/>
    <text x="400" y="290" class="text">QRコード読取開始</text>

    <!-- 読み取り -->
    <rect x="300" y="350" width="200" height="60" class="box"/>
    <text x="400" y="380" class="text">QRコード検出</text>

    <!-- IP取得 -->
    <rect x="300" y="440" width="200" height="60" class="box"/>
    <text x="400" y="470" class="text">端末IP取得<br/>（user_id）</text>

    <!-- JSON作成 -->
    <rect x="300" y="530" width="200" height="60" class="box"/>
    <text x="400" y="560" class="text">出席データ作成<br/>(JSON)</text>

    <!-- サーバ送信 -->
    <rect x="300" y="620" width="200" height="60" class="box"/>
    <text x="400" y="650" class="text">サーバへ送信<br/>(POST)</text>

    <!-- 成功？ -->
    <polygon points="400,720 520,770 400,820 280,770" class="decision"/>
    <text x="400" y="765" class="text">送信成功？</text>

    <!-- Web遷移 -->
    <rect x="530" y="840" width="220" height="60" class="end"/>
    <text x="640" y="870" class="text">Webページ遷移<br/>(index.php)</text>

    <!-- エラー -->
    <rect x="50" y="840" width="220" height="60" class="box"/>
    <text x="160" y="870" class="text">エラーメッセージ表示</text>

    <!-- 矢印 -->
    <line x1="400" y1="70" x2="400" y2="100" class="arrow"/>
    <line x1="400" y1="200" x2="400" y2="260" class="arrow"/>
    <line x1="280" y1="150" x2="160" y2="230" class="arrow"/>
    <line x1="400" y1="320" x2="400" y2="350" class="arrow"/>
    <line x1="400" y1="410" x2="400" y2="440" class="arrow"/>
    <line x1="400" y1="500" x2="400" y2="530" class="arrow"/>
    <line x1="400" y1="590" x2="400" y2="620" class="arrow"/>
    <line x1="400" y1="680" x2="400" y2="720" class="arrow"/>
    <line x1="280" y1="770" x2="160" y2="840" class="arrow"/>
    <line x1="520" y1="770" x2="640" y2="840" class="arrow"/>

</svg>

</body>
</html>
